<!DOCTYPE html>
<html lang="en">
  <head>
    <title>The Art of Idea: New node-windows</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Powered-By" content="DocPad v6.34.2"/>
    <meta name="description" content="I've made several major changes to node-windows.
There are no more dependencies on native node modules, a new service manager has been implemented,
a new logging feature is available, and new commands have been added.

">
    <meta name="author" content="Corey Butler (corey@coreybutler.com)">
    <meta name="keywords" content="goldglovecb, corey, butler, corey butler, node.js, javascript, ngn, thinkfirst, entrepreneur, coldfusion, ajax, html, web development, web design, git, programming, hacking, hackathon">
  
    <!-- Social SEO -->
    <meta property="og:title" content="The Art of Idea: New node-windows" />
    <meta property="og:description" content="I've made several major changes to node-windows.
There are no more dependencies on native node modules, a new service manager has been implemented,
a new logging feature is available, and new commands have been added.

" />
    
    <meta property="og:type" content="website" />
    
    <meta property="og:author" content="Corey Butler (corey@coreybutler.com)" />
    <meta property="og:site_name" content="The Art of Idea" />
    <meta property="og:locale" content="en" />
  
    <!-- Styling -->
    <link  rel="stylesheet" href="/../../css/aoi.css" /><link  rel="stylesheet" href="/../../css/aoi-responsive.css" />
    <link  rel="stylesheet" href="/../../metro/css/modern.css" /><link  rel="stylesheet" href="/../../metro/css/modern-responsive.css" />
    
    
    
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if IE 7]><link rel="stylesheet" href="/css/font-awesome-ie7.css"><![endif]-->

    <link rel="shortcut icon" href="http://www.gravatar.com/avatar/b8a1284b0d0202c5866d40c04b8bd842?s=16">
  </head>

  <body>
  <div class="nav-bar bg-color-blue">
    <div class="nav-bar-inner padding10">
      <div class="page">
        <div class="tb"><div class="nav-bar bg-color-blue">
  <div class="nav-bar-inner padding10">
    <ul class="menu">
      <li><a href="http://artofidea.com"><i class="icon-home"></i></a></li>
      <li class="divider"></li>
      
        
          <li><a href="http://artofidea.com/about">The Art of Idea</a></li>
        
      
        
          <li><a href="http://artofidea.com/cookbook/development">Inspiration</a></li>
        
      
        
          <li><a href="http://artofidea.com">Career</a></li>
        
      
        
          <li><a href="http://artofidea.com">Entrepreneurship</a></li>
        
      
        
          <li><a href="http://artofidea.com">Ventures</a></li>
        
      
        
          <li><a href="http://artofidea.com#">Corey Butler</a></li>
        
      
      <li class="divider"></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="Follow&nbsp;on&nbsp;Google+" href="https://plus.google.com/111169756342687497578?rel=author" target="_blank"><i class="icon icon-google-plus"></i></a></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="Connect&nbsp;on&nbsp;LinkedIn" href="http://www.linkedin.com/in/coreyabutler" target="_blank"><i class="icon icon-linkedin"></i></a></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="Projects&nbsp;on&nbsp;Github" href="http://github.com/coreybutler" target="_blank"><i class="icon icon-github"></i></a></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="Follow&nbsp;@goldglovecb" href="http://twitter.com/goldglovecb" target="_blank"><i class="icon icon-twitter"></i></a></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="Call&nbsp;me&nbsp;on&nbsp;Clarity.fm" href="https://clarity.fm/coreybutler" target="_blank"><i class="icon icon-phone"></i></a></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="RSS&nbsp;Feed" href="http://artofidea.com/atom" target="_blank"><i class="icon icon-feed"></i></a></li>
      <li><a style="float:left !important; clear:none;" data-placement="bottom" data-toggle="tooltip" rel="tooltip" data-original-title="Subscribe" href="http://feedburner.google.com/fb/a/mailverify?uri=ArtOfIdea&loc=en_US" rel="subscribe-email" title="subscribe via email" target="_blank"><i class="icon icon-mail"></i></a></li>
          
    </ul>
  </div>
</div>
</div>
        <h1 class="title">New node-windows</h1>
      </div>
    </div>
  </div>
  <div class="page">
    <span class="subtitle">Published on Sunday, March 24, 2013 by Corey Butler</span>
    <div class="page-region">
      <div class="page-region-content post">
        <p>I&#39;ve made several major changes to <a href="http://github.com/coreybutler/node-windows">node-windows</a>.
There are no more dependencies on native node modules, a new service manager has been implemented,
a new logging feature is available, and new commands have been added.</p>
<!-- more -->

<div id="tldr">
  <li>Several permissions issues have been resolved.</li>
  <li>&quot;npm install -g node-windows&quot; no longer requires Visual Studio or the .NET framework.</li>
  <li>Easier to create Windows background services from code.</li>
  <li>New list and kill task methods.</li>
  <li>MIT &amp; BSD Licenses</li>
</div>

<p>It has been about a month since I released node-windows.
Since then, I have been working hard on my main Node.js project, which targets multiple platforms.
I&#39;ve been lucky enough to have other folks do some testing on node-windows though. As a result,
several issues have been fixed.</p>
<h2>Challenges Overcome</h2>
<p><strong>node-windows no longer has any dependencies on C++ modules!</strong></p>
<p>Node.js developers using Windows face the <code>npm challenge</code>. For those who haven&#39;t done Node.js
development on Windows, you can leverage C++ modules like anyone else, but since most developers
distribute them in source format, you have to compile them. This sucks on Windows. Though <code>npm</code> does have
a built-in utility for doing this, it is dependent on software that must be installed on the
desktop in order to work properly. On Windows, this means installing Visual Basic and the .NET
3.5 framework. Visual Studio is huge. 2GB+ huge. This is further complicated by flags/switches
if you&#39;re using VS2012 as opposed to VS2010 (or, ugh, both). It stifles Windows developers,
especially new developers, and sort of raises this false mantra that you either need to use a Mac
or &quot;just deal with it&quot;.</p>
<p>While the C++ modules used in the first release of node-windows were very helpful, they
relied on this painful development environment. The new version has replaced all
of these with alternatives. Some features still require a <code>.exe</code>, but these are prepackaged
and distributed with the module. This alleviates the need to build node-windows during the
npm installation. That doesn&#39;t change anything for those who need to use other C++ modules,
but I&#39;ve done what I can to make sure node-windows is easy to use.</p>
<p><strong>node-windows uses new permission detection!</strong></p>
<p>Some developers pointed out issues of being falsely identified as a non-administrative user.
This has been resolved on all versions of Windows I have access to.</p>
<p><strong>node-windows won&#39;t put you in callback hell</strong></p>
<p>The code, specifically the background services part, has been refactored to remove callbacks. Now
everything is driven by a series of simple events.</p>
<h2>New &amp; Updated Features</h2>
<ul>
<li>New Event Logging</li>
<li>Task <code>list</code> &amp; <code>kill</code> are now functional.</li>
<li><code>isAdminUser</code> now uses the new permission detection.</li>
<li>Services/daemons have been completely overhauled. Easier syntax, more robust, better logging.</li>
<li>Examples</li>
<li>Updated Documentation</li>
<li><code>nssm.exe</code> was replaced with <code>winsw.exe</code> (MIT)</li>
</ul>
<h2>A Word on Native Functionality</h2>
<p>With languages like Node.js, it is easy to rewrite functionality, simply
because it&#39;s simple to write the code. Process monitoring and logging is just one of those areas.
The major operating systems already have support for this. Rewriting it in Node.js is fun,
but it really is redundant with what the operating system already offers.</p>
<p>The approach I took with node-windows was to leverage as much of the operating system&#39;s core
functiniality as I could. The only time I made changes is when the operating system didn&#39;t
fully support a feature. In other words, node-windows was designed to augment functionality,
not full on replace it.</p>
<p>As a result, a different kind of workflow is available with node-windows. Since node-windows
can create native background services out of a Node.js script, traditional Windows tooling
can be used. Already using a service monitor to alert you when a process dies? It will work
with a node-windows service. Perhaps you&#39;re using a Windows log watcher? node-windows processes
will work with that too since they use the same logging mechanism every other application uses.</p>
<h2>Conclusion</h2>
<p>While node-windows only has a few new features, the underlying code has been overhauled in an
effort to make the module more developer and sysadmin friendly. That said, I&#39;d love to know if
you&#39;re using it. If you have any issues, please log them on the <a href="https://github.com/coreybutler/node-windows">Github page</a>.</p>
<p>Now it&#39;s time to get working on <code>node-mac</code>!</p>

        <span class="row-fluid">
          <div class="span12">
            <div style="float: right;">
              <iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fartofidea.com%2Fcookbook%5Cdevelopment%5Carticles%2Fnode-windows2&amp;send=false&amp;layout=button_count&amp;width=105&amp;show_faces=false&amp;font=lucida+grande&amp;colorscheme=light&amp;action=like&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:105px; height:21px;" allowTransparency="true"></iframe>
              <div class="g-plusone" data-size="medium"></div>
<script type="text/javascript">(function(){var po=document.createElement('script');po.type='text/javascript';po.async=true;po.src='https://apis.google.com/js/plusone.js',s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(po,s);})();</script>
              <a href="https://twitter.com/share" class="twitter-share-button" data-count="" data-via="goldglovecb" data-size="small" data-hashtags="artofidea,node.js,npm,windows">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
              <script src="//platform.linkedin.com/in.js" type="text/javascript"></script>
<script type="IN/Share" data-counter="right" data-showzero="true"></script>
            </div>  
          </div>
        </span>
      </div>
    </div>
  </div>
  
  <div class="page related">
    <h2>More Articles:</h2>
    <ol>
    
      <li><a href="/cookbook\development\articles/fenix">Fenix</a> (3/30/2013)</li>
    
      <li><a href="/cookbook\development\articles/node-mac">Introducing node-mac</a> (5/18/2013)</li>
    
      <li><a href="/cookbook\development\articles/node-windows">Introducing node-windows</a> (2/16/2013)</li>
    
      <li><a href="/cookbook\development\articles/nodejs-and-microsoft-azure">NodeJS & Microsoft Azure</a> (12/11/2011)</li>
    
    </ol>
  </div>
  
  
  <div class="page comments">
    <h2>Comments</h2>
    <!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    (function() {
        window.disqus_shortname = 'artofidea';
        window.disqus_developer = 0;
        window.disqus_url = document.location.href;
        window.disqus_identifier = 'services-disqus';
        window.disqus_title = 'disqus.html';
        if ( window.DISQUS ) {
            return DISQUS.reset({
                reload: true,
                config: function () {
                    this.page.identifier = window.disqus_identifier;
                    this.page.url = window.disqus_url;
                    this.page.title = window.disqus_title;
                }
            });
        }
        else {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
    
    <a href="#" class="scrollup"></a>
    
    <script defer="defer"  src="/../../js/jquery.js"></script><script defer="defer"  src="/../../js/bootstrap-tooltip-min.js"></script><script defer="defer"  src="/../../js/jquery.scrollto-1.4.3.1-min.js"></script><script defer="defer"  src="/../../js/jquery.localscroll-1.2.7-min.js"></script><script defer="defer"  src="/../../js/common.js"></script>
    
    
    
  </body>
</html>